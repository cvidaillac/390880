{
  "modelVersion" : "2.2",
  "previousArtifactVersion" : "2.0",
  "id" : "1920b5df-fb36-4a1e-be83-2a69ba769758",
  "name" : "pop3pHomePageLAC",
  "lastUpdate" : 1671627881965,
  "rows" : [
    [
      {
        "type" : "container",
        "dimension" : {
          "xs" : 12,
          "sm" : 12,
          "md" : 12,
          "lg" : 12
        },
        "propertyValues" : {
          "cssClasses" : {
            "type" : "constant",
            "value" : ""
          },
          "hidden" : {
            "type" : "expression",
            "value" : "canAccess"
          },
          "repeatedCollection" : {
            "type" : "variable",
            "value" : ""
          }
        },
        "reference" : "a6c0bcfa-f117-4145-a732-aa9ae96b94e7",
        "hasValidationError" : false,
        "id" : "pbContainer",
        "rows" : [
          [
            {
              "type" : "component",
              "dimension" : {
                "xs" : 12,
                "sm" : 12,
                "md" : 12,
                "lg" : 12
              },
              "propertyValues" : {
                "cssClasses" : {
                  "type" : "constant",
                  "value" : ""
                },
                "hidden" : {
                  "type" : "constant",
                  "value" : false
                },
                "text" : {
                  "type" : "interpolation",
                  "value" : "<br><b><font color=\"red\">Accès refusé. Veuillez contacter votre administrateur"
                },
                "alignment" : {
                  "type" : "constant",
                  "value" : "left"
                },
                "allowHTML" : {
                  "type" : "constant",
                  "value" : true
                },
                "labelHidden" : {
                  "type" : "constant",
                  "value" : true
                },
                "label" : {
                  "type" : "interpolation",
                  "value" : ""
                },
                "labelPosition" : {
                  "type" : "constant",
                  "value" : "top"
                },
                "labelWidth" : {
                  "type" : "constant",
                  "value" : 4
                }
              },
              "reference" : "e4696d84-94de-44f2-b1c6-3789ea85cfc9",
              "hasValidationError" : false,
              "id" : "pbText"
            }
          ]
        ]
      }
    ],
    [
      {
        "type" : "container",
        "dimension" : {
          "xs" : 12,
          "sm" : 12,
          "md" : 12,
          "lg" : 12
        },
        "propertyValues" : {
          "cssClasses" : {
            "type" : "constant",
            "value" : ""
          },
          "hidden" : {
            "type" : "expression",
            "value" : "!canAccess"
          },
          "repeatedCollection" : {
            "type" : "variable",
            "value" : ""
          }
        },
        "reference" : "38876996-eb25-4d9a-ba96-5dc3edf3129a",
        "hasValidationError" : false,
        "id" : "pbContainer",
        "rows" : [
          [
            {
              "type" : "component",
              "dimension" : {
                "xs" : 12,
                "sm" : 12,
                "md" : 6,
                "lg" : 6
              },
              "propertyValues" : {
                "cssClasses" : {
                  "type" : "constant",
                  "value" : ""
                },
                "hidden" : {
                  "type" : "constant",
                  "value" : false
                },
                "text" : {
                  "type" : "interpolation",
                  "value" : "Liste des tâches"
                },
                "level" : {
                  "type" : "constant",
                  "value" : "Level 2"
                },
                "alignment" : {
                  "type" : "constant",
                  "value" : "left"
                }
              },
              "reference" : "79cba5e7-c412-45c0-9d8a-05f239250639",
              "hasValidationError" : false,
              "id" : "pbTitle"
            }
          ],
          [
            {
              "type" : "component",
              "dimension" : {
                "xs" : 12,
                "sm" : 12,
                "md" : 12,
                "lg" : 12
              },
              "propertyValues" : {
                "cssClasses" : {
                  "type" : "constant",
                  "value" : ""
                },
                "hidden" : {
                  "type" : "constant",
                  "value" : false
                },
                "filtersLabels" : {
                  "type" : "expression",
                  "value" : "listFiltersTest"
                },
                "urlGenerate" : {
                  "type" : "variable",
                  "value" : "urlFilters"
                },
                "multipleSelect" : {
                  "type" : "variable",
                  "value" : "filterEntitiesSelected"
                }
              },
              "reference" : "e4987346-a42a-4028-b391-7e35b05d1b37",
              "hasValidationError" : false,
              "id" : "customListFilters"
            }
          ],
          [
            {
              "type" : "component",
              "dimension" : {
                "xs" : 12,
                "sm" : 12,
                "md" : 12,
                "lg" : 6
              },
              "propertyValues" : {
                "cssClasses" : {
                  "type" : "constant",
                  "value" : ""
                },
                "hidden" : {
                  "type" : "constant",
                  "value" : false
                },
                "disabled" : {
                  "type" : "expression",
                  "value" : "test.length===0 || test===undefined"
                },
                "required" : {
                  "type" : "constant",
                  "value" : false
                },
                "label" : {
                  "type" : "interpolation",
                  "value" : "Mes entités uniquement"
                },
                "value" : {
                  "type" : "variable",
                  "value" : "entityOnly"
                }
              },
              "reference" : "2fa66ae6-d633-4d51-aac0-5de43bf0be22",
              "hasValidationError" : false,
              "id" : "pbCheckbox"
            }
          ],
          [
            {
              "type" : "component",
              "dimension" : {
                "xs" : 6,
                "sm" : 6,
                "md" : 6,
                "lg" : 8
              },
              "propertyValues" : {
                "cssClasses" : {
                  "type" : "constant",
                  "value" : ""
                },
                "hidden" : {
                  "type" : "constant",
                  "value" : false
                },
                "text" : {
                  "type" : "interpolation",
                  "value" : "Tâches à traiter"
                },
                "level" : {
                  "type" : "constant",
                  "value" : "Level 4"
                },
                "alignment" : {
                  "type" : "constant",
                  "value" : "left"
                }
              },
              "reference" : "7efb4df7-3ad4-4050-890d-8ca969fbc41c",
              "hasValidationError" : false,
              "id" : "pbTitle"
            },
            {
              "type" : "component",
              "dimension" : {
                "xs" : 6,
                "sm" : 6,
                "md" : 6,
                "lg" : 4
              },
              "propertyValues" : {
                "cssClasses" : {
                  "type" : "constant",
                  "value" : ""
                },
                "hidden" : {
                  "type" : "constant",
                  "value" : false
                },
                "disabled" : {
                  "type" : "constant",
                  "value" : false
                },
                "label" : {
                  "type" : "interpolation",
                  "value" : "<span class=\"glyphicon glyphicon-refresh\"></span> Recharger"
                },
                "alignment" : {
                  "type" : "constant",
                  "value" : "right"
                },
                "buttonStyle" : {
                  "type" : "constant",
                  "value" : "default"
                },
                "apiUrl" : {
                  "type" : "interpolation",
                  "value" : "{{urlListTasks}}"
                },
                "apiSuccess" : {
                  "type" : "variable",
                  "value" : "listTasks"
                },
                "urlList" : {
                  "type" : "interpolation",
                  "value" : "{{completeDataUrl}}"
                },
                "successResponse" : {
                  "type" : "variable",
                  "value" : "urlList"
                },
                "errorResponse" : {
                  "type" : "variable",
                  "value" : ""
                }
              },
              "reference" : "6060a017-f4c0-40df-b114-00b3e6cc2767",
              "hasValidationError" : false,
              "id" : "customRefreshButton"
            }
          ],
          [
            {
              "type" : "component",
              "dimension" : {
                "xs" : 12,
                "sm" : 12,
                "md" : 12,
                "lg" : 12
              },
              "propertyValues" : {
                "cssClasses" : {
                  "type" : "constant",
                  "value" : ""
                },
                "hidden" : {
                  "type" : "constant",
                  "value" : false
                },
                "headers" : {
                  "type" : "constant",
                  "value" : [
                    "N°Prop",
                    "Tâche",
                    "Affectation",
                    "Echéance",
                    "N°matériel-Genre",
                    "Entité-Agence",
                    "Motif",
                    "Exercice-Livraison prévue"
                  ]
                },
                "type" : {
                  "type" : "constant",
                  "value" : "Variable"
                },
                "apiUrl" : {
                  "type" : "constant",
                  "value" : "../API/"
                },
                "params" : {
                  "type" : "constant"
                },
                "content" : {
                  "type" : "expression",
                  "value" : "listFiltredbyEntities"
                },
                "columnsKey" : {
                  "type" : "constant",
                  "value" : [
                    "searchIndex2",
                    "displayName",
                    "reachedStateDate",
                    "expectedEndDate|uiDate:'short'",
                    "searchIndex1",
                    "searchIndex3",
                    "searchIndex4",
                    "searchIndex5"
                  ]
                },
                "sortColumns" : {
                  "type" : "constant"
                },
                "selectedRow" : {
                  "type" : "variable",
                  "value" : "selectedTask"
                },
                "pageSize" : {
                  "type" : "constant",
                  "value" : 10
                },
                "filter" : {
                  "type" : "expression",
                  "value" : "taskFilter"
                },
                "currentPage" : {
                  "type" : "variable",
                  "value" : ""
                }
              },
              "reference" : "c7a5ea3a-6df9-4e15-a5ec-7a1039367e3b",
              "hasValidationError" : false,
              "id" : "customTaskListDataTable"
            }
          ],
          [
            {
              "type" : "component",
              "dimension" : {
                "xs" : 12,
                "sm" : 12,
                "md" : 12,
                "lg" : 12
              },
              "propertyValues" : {
                "cssClasses" : {
                  "type" : "constant",
                  "value" : "alert alert-warning"
                },
                "hidden" : {
                  "type" : "expression",
                  "value" : "!listTasks.length == 0"
                },
                "text" : {
                  "type" : "interpolation",
                  "value" : "<br><b>Vous n'avez pas de tâche(s) <br>à traiter actuellement !</b>"
                },
                "alignment" : {
                  "type" : "constant",
                  "value" : "center"
                },
                "allowHTML" : {
                  "type" : "constant",
                  "value" : true
                },
                "labelHidden" : {
                  "type" : "constant",
                  "value" : true
                },
                "label" : {
                  "type" : "interpolation",
                  "value" : ""
                },
                "labelPosition" : {
                  "type" : "constant",
                  "value" : "top"
                },
                "labelWidth" : {
                  "type" : "constant",
                  "value" : 4
                }
              },
              "reference" : "cb77db8d-4761-4d0b-b0ec-feb3b5723ae5",
              "hasValidationError" : false,
              "id" : "pbText"
            }
          ]
        ]
      }
    ]
  ],
  "assets" : [
    {
      "id" : "d4c2721b-7fc9-4d3e-99e3-2b6eaffe41d9",
      "name" : "localization.json",
      "type" : "json",
      "order" : 0,
      "external" : false
    },
    {
      "id" : "6cdacea3-6a20-4bdb-8e41-6c2445eb9d63",
      "name" : "style.css",
      "type" : "css",
      "order" : 0,
      "external" : false
    },
    {
      "id" : "c294c2cc-032d-4825-af33-e026f11eff7d",
      "name" : "customModal.css",
      "type" : "css",
      "order" : 1,
      "external" : false
    }
  ],
  "inactiveAssets" : [ ],
  "variables" : {
    "listFiltersTest" : {
      "type" : "expression",
      "value" : [
        "/*var result =",
        "[",
        "\t{",
        "\t\t\"data\" : \"searchIndex5\",",
        "\t\t\"label\" : \"Exercice\",",
        "\t\t\"type\" : \"text\",",
        "\t\t\"operator\" : \"L\"",
        "\t},",
        "\t{",
        "\t\t\"data\" : \"displayName\",",
        "\t\t\"label\" : \"Nom de la tache\",",
        "\t\t\"type\" : \"text\",",
        "\t\t\"operator\" : \"L\"",
        "\t},",
        "\t{",
        "\t\t\"data\" : \"searchIndex1\",",
        "\t\t\"label\" : \"Numéro matériel\",",
        "\t\t\"type\" : \"text\",",
        "\t\t\"isDisable\" : false,",
        "\t\t\"operator\" : \"L\"",
        "\t},",
        "\t{",
        "\t\t\"data\" : \"searchIndex2\",",
        "\t\t\"label\" : \"Id de proposition\",",
        "\t\t\"type\" : \"text\",",
        "\t\t\"operator\" : \"L\"",
        "\t},",
        "\t\t{",
        "\t\t\"data\" : \"searchIndex4\",",
        "\t\t\"label\" : \"Motif\",",
        "\t\t\"type\" : \"text\",",
        "\t\t\"operator\" : \"L\"",
        "\t},",
        "\t{",
        "\t\t\"data\" : \"searchIndex3\",",
        "\t\t\"label\" : \"Entité\",",
        "\t\t\"type\" : \"selectMulti\",",
        "\t\t\"operator\":\"L\",",
        "\t\t\"values\": $data.listEntites",
        "\t}",
        "] ",
        "",
        "return result*/",
        "",
        "//changes made by Amit for BPM-40",
        "var result =",
        "[",
        "\t{",
        "\t\t\"data\" : \"searchIndex2\",",
        "\t\t\"label\" : \"N° proposition\",",
        "\t\t\"type\" : \"text\",",
        "\t\t\"operator\" : \"L\"",
        "\t},",
        "\t{",
        "\t\t\"data\" : \"displayName\",",
        "\t\t\"label\" : \"Tâche\",",
        "\t\t\"type\" : \"text\",",
        "\t\t\"operator\" : \"L\"",
        "\t},",
        "\t{",
        "\t\t\"data\" : \"searchIndex1\",",
        "\t\t\"label\" : \"N° matériel\",",
        "\t\t\"type\" : \"text\",",
        "\t\t\"isDisable\" : false,",
        "\t\t\"operator\" : \"L\"",
        "\t},",
        "\t{",
        "\t\t\"data\" : \"searchIndex3\",",
        "\t\t\"label\" : \"Entité\",",
        "\t\t\"type\" : \"selectMulti\",",
        "\t\t//\"operator\":\"L\",",
        "\t\t\"values\": $data.listEntites",
        "\t},",
        "\t{",
        "\t\t\"data\" : \"searchIndex4\",",
        "\t\t\"label\" : \"Motif\",",
        "\t\t\"type\" : \"text\",",
        "\t\t\"operator\" : \"L\"",
        "\t},",
        "\t{",
        "\t\t\"data\" : \"searchIndex5\",",
        "\t\t\"label\" : \"Exercice\",",
        "\t\t\"type\" : \"text\",",
        "\t\t\"operator\" : \"L\"",
        "\t}",
        "\t",
        "]; ",
        "",
        "return result;"
      ],
      "exposed" : false
    },
    "test" : {
      "type" : "url",
      "value" : [
        "../API/extension/lacEntity?sgid={{userName}}"
      ],
      "exposed" : false
    },
    "groupId" : {
      "type" : "expression",
      "value" : [
        "return $data.GROUPE_BO[0].id;"
      ],
      "exposed" : false
    },
    "selectedTask" : {
      "type" : "json",
      "value" : [
        "{}"
      ],
      "exposed" : false
    },
    "userName" : {
      "type" : "expression",
      "value" : [
        "return $data.getSession.user_name;"
      ],
      "exposed" : false
    },
    "listFiltredbyEntities" : {
      "type" : "expression",
      "value" : [
        "if($data.listTasks){",
        "    for(var l=0;l<$data.listTasks.length;l++){",
        "         if($data.listTasks[l].searchIndex2){",
        "        $data.listTasks[l].searchIndex2 = Number($data.listTasks[l].searchIndex2);",
        "    }",
        "  }",
        "}",
        "",
        "var filteredTable = $data.listTasks.slice(0);",
        "var myEntities = [];",
        "         ",
        "if($data.filterEntitiesSelected.length > 0)",
        "{",
        "for(var i=0; i< filteredTable.length; i++)",
        "{",
        "   // IDF - Ile de France",
        "    var found = $data.filterEntitiesSelected.includes(filteredTable[i].searchIndex3.split(',')[0]);",
        "      if(!found)",
        "      {",
        "         filteredTable.splice(i,1); ",
        "         i--;",
        "     }",
        "    ",
        "    ",
        "}",
        "",
        "}",
        "if($data.test!==undefined)",
        "{",
        "if($data.test.length>0)",
        "{",
        "    ",
        "for(var j=0; j< $data.test.length; j++)",
        "{",
        "    myEntities.push(j, $data.test[j].entite);",
        "}",
        "",
        "if($data.entityOnly===true)",
        "{",
        "",
        "for(var k=0; k< filteredTable.length; k++)",
        "{",
        "   // IDF - Ile de France",
        "    var here = myEntities.includes(filteredTable[k].searchIndex3.split(',')[0]);",
        "    if(!here)",
        "      {",
        "         filteredTable.splice(k,1); ",
        "         k--;",
        "      }",
        "    ",
        "    ",
        "}",
        "",
        "}",
        "}",
        "}",
        " filteredTable.sort(function(a, b){return a.searchIndex2 - b.searchIndex2}); ",
        "",
        "return filteredTable;"
      ],
      "exposed" : false
    },
    "isBOMember" : {
      "type" : "expression",
      "value" : [
        "if ($data.VerifyMemberShip.length===0){",
        "    ",
        "    return false;",
        "}",
        "",
        "return true;"
      ],
      "exposed" : false
    },
    "user_Id" : {
      "type" : "expression",
      "value" : [
        "return $data.getSession.user_id;"
      ],
      "exposed" : false
    },
    "listTasks" : {
      "type" : "url",
      "value" : [
        "{{urlListTasks}}"
      ],
      "exposed" : false
    },
    "listFilters" : {
      "type" : "expression",
      "value" : [
        "var result =",
        "[",
        "\t{",
        "\t\t\"data\" : \"searchIndex5\",",
        "\t\t\"label\" : \"Exercice\",",
        "\t\t\"type\" : \"text\",",
        "\t\t\"operator\" : \"L\"",
        "\t},",
        "\t{",
        "\t\t\"data\" : \"displayName\",",
        "\t\t\"label\" : \"Nom de la tache\",",
        "\t\t\"type\" : \"text\",",
        "\t\t\"operator\" : \"L\"",
        "\t},",
        "\t{",
        "\t\t\"data\" : \"searchIndex1\",",
        "\t\t\"label\" : \"Numéro matériel\",",
        "\t\t\"type\" : \"text\",",
        "\t\t\"isDisable\" : false,",
        "\t\t\"operator\" : \"L\"",
        "\t},",
        "\t{",
        "\t\t\"data\" : \"searchIndex2\",",
        "\t\t\"label\" : \"Id de proposition\",",
        "\t\t\"type\" : \"text\",",
        "\t\t\"operator\" : \"L\"",
        "\t},",
        "\t\t{",
        "\t\t\"data\" : \"searchIndex4\",",
        "\t\t\"label\" : \"Motif\",",
        "\t\t\"type\" : \"text\",",
        "\t\t\"operator\" : \"L\"",
        "\t}",
        "] ;",
        "",
        "return result;"
      ],
      "exposed" : false
    },
    "entityOnly" : {
      "type" : "expression",
      "value" : [
        "if($data.test.length>0)",
        "{",
        "return true;",
        "}",
        "else",
        "{",
        "return false;",
        "}"
      ],
      "exposed" : false
    },
    "canAccess" : {
      "type" : "expression",
      "value" : [
        "for(var i=0;i<$data.VerifyMemberShip.length;i++)",
        "{",
        "    ",
        "    if($data.VerifyMemberShip[i].group_id==$data.groupId){",
        "        return true;",
        "    }",
        "}",
        "",
        "return false;"
      ],
      "exposed" : false
    },
    "filterEntitiesSelected" : {
      "type" : "json",
      "value" : [
        "[]"
      ],
      "exposed" : false
    },
    "taskFilter" : {
      "type" : "constant",
      "exposed" : false
    },
    "urlList" : {
      "type" : "url",
      "value" : [
        "../API/extension/getCustomTasks?commande=LACTasks"
      ],
      "exposed" : false
    },
    "VerifyMemberShip" : {
      "type" : "url",
      "value" : [
        "../API/identity/membership?p=0&c=10000&f=user_id={{user_Id}}"
      ],
      "exposed" : false
    },
    "urlListTasks" : {
      "type" : "expression",
      "value" : [
        "return \"../API/extension/getCustomTasks?commande=LACTasks\"+$data.urlFilters;"
      ],
      "exposed" : false
    },
    "GROUPE_BO" : {
      "type" : "url",
      "value" : [
        "../API/identity/group?p=0&c=100&f=displayName=GROUPE_LAC"
      ],
      "exposed" : false
    },
    "getSession" : {
      "type" : "url",
      "value" : [
        "../API/system/session/1"
      ],
      "exposed" : false
    },
    "urlFilters" : {
      "type" : "constant",
      "exposed" : false
    },
    "listEntites" : {
      "type" : "expression",
      "value" : [
        "var listEntites = [];",
        "var myEntities =[];",
        "",
        "for(var i=0; i < $data.urlList.length; i++)",
        "{",
        "    if(!listEntites.includes($data.urlList[i].searchIndex3.split(',')[0])){",
        "    listEntites.push($data.urlList[i].searchIndex3.split(',')[0]);",
        "}",
        "}",
        "if($data.test!==undefined)",
        "{",
        "",
        "if($data.test.length>0)",
        "{",
        "    ",
        "for(var j=0; j< $data.test.length; j++)",
        "{",
        "    myEntities.push(j, $data.test[j].entite);",
        "}",
        "}",
        "",
        "",
        "if($data.entityOnly===true)",
        "{",
        "",
        "for(var k=0; k< listEntites.length; k++)",
        "{",
        "   // IDF - Ile de France",
        "    var here = myEntities.includes(listEntites[k]);",
        "    if(!here)",
        "      {",
        "         listEntites.splice(k,1); ",
        "         k--;",
        "      }",
        "    ",
        "    ",
        "}",
        "}",
        "}",
        "",
        "",
        "",
        "",
        "return listEntites;"
      ],
      "exposed" : false
    },
    "completeDataUrl" : {
      "type" : "expression",
      "value" : [
        "return \"../API/extension/getCustomTasks?commande=LACTasks\";"
      ],
      "exposed" : false
    }
  },
  "hasValidationError" : false,
  "uuid" : "1920b5df-fb36-4a1e-be83-2a69ba769758",
  "type" : "page",
  "description" : "Page generated with Bonita UI designer"
}